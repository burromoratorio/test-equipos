{"remainingRequest":"/home/siacadmin/Documentos/developJs/test-equipos/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/siacadmin/Documentos/developJs/test-equipos/src/views/equipos/S2000.vue?vue&type=style&index=0&id=ad235da8&scoped=true&lang=css&","dependencies":[{"path":"/home/siacadmin/Documentos/developJs/test-equipos/src/views/equipos/S2000.vue","mtime":1540922415712},{"path":"/home/siacadmin/Documentos/developJs/test-equipos/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/home/siacadmin/Documentos/developJs/test-equipos/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/siacadmin/Documentos/developJs/test-equipos/node_modules/cache-loader/dist/cjs.js","mtime":1539779891905},{"path":"/home/siacadmin/Documentos/developJs/test-equipos/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.fade-enter-active {\n  transition: all .3s ease;\n}\n.fade-leave-active {\n  transition: all .8s cubic-bezier(1.0, 0.5, 0.8, 1.0);\n}\n.fade-enter, .fade-leave-to {\n  transform: translateX(10px);\n  opacity: 0;\n}\n",{"version":3,"sources":["S2000.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"S2000.vue","sourceRoot":"src/views/equipos","sourcesContent":["<template>\n  <div class=\"animated fadeIn\">\n    <b-row class=\"justify-content-center\">\n      <b-form>\n        <h1>Test de Comandos</h1>\n        <b-form-group>\n            <b-input-group>\n              <!-- Attach Left button -->\n              <b-input-group-prepend>\n                <b-button v-on:click=\"search(equipo_id)\" variant=\"primary\">\n                  <i class=\"fa fa-search\"></i>Buscar \n                </b-button>\n              </b-input-group-prepend>\n              <b-form-input type=\"text\" placeholder=\"EquipoID\" v-model=\"equipo_id\" name=\"equipo_id\"></b-form-input>\n              <b-col cols=\"6\" sm=\"4\" md=\"2\" xl class=\"mb-3 mb-xl-0\">\n               <!-- <b-button block variant=\"outline-info\" v-on:click=\"testEquipo(equipo_id)\">Test</b-button>-->\n              <b-button v-on:click=\"togglePress ?testEquipo(equipo_id):finalizarTest(equipo_id)\" variant=\"outline-primary\" :pressed.sync=\"togglePress\">\n                    Test {{togglePress ? 'On ' : 'Off'}}\n                </b-button>\n              </b-col>\n            </b-input-group>\n          </b-form-group>\n      </b-form>\n    </b-row>\n    <b-row class=\"justify-content-center\">\n     <b-col sm=\"12\" md=\"4\">\n        <transition name=\"fade\" v-if=\"show\">\n          <b-card class=\"bg-secondary\" no-body >\n            <div slot=\"header\">\n              Informacion de equipos\n              <div class=\"card-header-actions\">\n                <b-link href=\"#\" class=\"card-header-action btn-setting\">\n                  <i class=\"icon-settings\"></i>\n                </b-link>\n                <b-link class=\"card-header-action btn-minimize\" v-b-toggle.collapse1>\n                  <i class=\"icon-arrow-up\"></i>\n                </b-link>\n                <b-link href=\"#\" class=\"card-header-action btn-close\" >\n                  <i class=\"icon-close\"></i>\n                </b-link>\n              </div>\n            </div>\n            <b-collapse id=\"collapse1\" visible>\n              <b-card-body>\n                {{mensajito}}\n              </b-card-body>\n            </b-collapse>\n          </b-card>\n        </transition>\n      </b-col>\n    </b-row>\n    <b-row>\n      <b-col>\n      <b-card :header=\"caption\">\n        <b-table small  :items=\"comandos\" :fields=\"fields\" :current-page=\"currentPage\" :per-page=\"perPage\">\n          <template slot=\"estado\" slot-scope=\"comandos\">\n            <b-badge :variant=\"getBadge(comandos.item.estado)\">{{comandos.item.estado}}</b-badge>\n          </template>\n        </b-table>\n        <nav>\n         <b-pagination :total-rows=\"getRowCount(comandos)\" :per-page=\"perPage\" v-model=\"currentPage\" prev-text=\"Prev\" next-text=\"Next\" hide-goto-end-buttons/>\n        </nav>\n      </b-card>\n      </b-col><!--/.col-->\n    </b-row><!--/.row-->\n    <b-row>\n      <b-col>\n      <b-card header=\"Alarmas\">\n        <b-table small  :items=\"alarmas\" :fields=\"fieldsAlarm\" :current-page=\"currentPage\" :per-page=\"perPage\">\n          <template slot=\"estado\" slot-scope=\"comandos\">\n            <b-badge :variant=\"getBadge(alarmas.item.estado)\">{{alarmas.item.estado}}</b-badge>\n          </template>\n        </b-table>\n        <nav>\n         <b-pagination :total-rows=\"getRowCount(alarmas)\" :per-page=\"perPage\" v-model=\"currentPage\" prev-text=\"Prev\" next-text=\"Next\" hide-goto-end-buttons/>\n        </nav>\n      </b-card>\n      </b-col><!--/.col-->\n    </b-row><!--/.row-->\n  </div>\n\n</template>\n\n<script>\nimport Vue from 'vue';\nimport DataService from '../../services/DataService';\nvar comandos = [];\nvar alarmas  = [];\nvar trs=[];\nvar recargas=0; \nvar equipo_id = 0;\nvar mensajito ='';\nconst dataservice = new DataService();\n\nexport default {\n  name: 's2000',\n  props: {\n    caption: {\n      type: String,\n      default: 'Table'\n    }\n  },\n  data () {\n    return {\n      loading: false,\n      equipo_id: null,\n      comandos:[],\n      alarmas:[],\n      trs:[],\n      recargas:0,\n      togglePress: false,\n      mensajito:'',\n      fields: [\n        {\n          key : 'tr_id',\n          sortable: true\n        },      \n        {\n          label: 'ComandoID',\n          key : 'cmd_id'\n        },\n        {\n          label: 'Comando',\n          key : 'comando',\n          sortable: true\n        },\n         {\n          label: 'Valores',\n          key : 'auxiliar'\n        },\n        {\n          label: 'RTA',\n          key : 'respuesta'\n        },\n        {\n          key : 'estado',\n          sortable: true\n        },\n        {\n          label: 'Fecha',\n          key : 'fecha_final',\n          sortable: true\n        },\n        {\n          label: 'prioridad',\n          key : 'prioridad',\n          sortable: true\n        }\n        \n      ],\n      currentPage: 1,\n      perPage: 10,\n      totalRows: 0,\n      show: false,\n      fieldsAlarm: [\n        {\n          key : 'tipo',\n          sortable: true\n        },\n        {\n          key : 'dominio',\n        },\n        {\n          label: 'Fecha',\n          key : 'fecha_alarma',\n          sortable: true\n        },      \n      ],\n    }\n  },\n   created () {\n    },\n  watch: {\n    // call again the method if the route changes\n    '$route': 'fetchData'\n   //this.search(equipo_id);\n  },\n  methods: {\n    fetchData (equipo_id) {\n      this.show = true;\n      dataservice.getComandos(equipo_id).then( result => {\n        this.comandos = result.data; \n        comandos=result.data;\n        \n      }).then(()=>{\n        if(comandos.length>0){\n          this.mensajito= 'Test en equipo: '+ equipo_id+ ' en proceso...';\n        }\n       //this.recargaConstante(this.comandos);\n      });  \n      \n    },\n    fetchAlarmas (equipo_id) {\n      this.show = true;\n      dataservice.getAlarmas(equipo_id).then( result => {\n        this.alarmas = result.data; \n        alarmas=result.data;\n        \n      }).then(()=>{\n        console.log('todo e todo');\n        //this.recargaConstante(this.comandos);\n      });  \n      \n    },\n    getBadge (status) {\n      return status === 'Ok' ? 'success'\n        : status === 'En Espera' ? 'secondary'\n          : status === 'En Proceso' ? 'warning'\n            : status === 'Cancelado' ? 'danger' : 'primary'\n    },\n    getRowCount (comandos) {\n      return comandos.length\n    },\n    search(equipo_id){\n      this.fetchData(equipo_id);\n      this.fetchAlarmas (equipo_id);\n    },\n    testEquipo(equipo_id){\n      dataservice.testEquipo({id:equipo_id}).then(()=>{\n        this.fetchData(equipo_id);\n        this.mensajito= 'Test en equipo: '+ equipo_id+ ' en proceso...';\n        /*setTimeout(function run() {\n            console.log(\"d\");\n            setTimeout(run, 1000);\n          }, 1000);*/\n        //this.$router.push({ path: '../equipos/lista/'});\n      });\n\n    },\n    finalizarTest(modem_id){\n      /*dataservice.finalizarTest(modem_id).then(()=>{\n        this.fetchData(modem_id);\n        mensajito= result;\n      });\n      console.log(modem_id);*/\n\n      dataservice.finalizarTest(modem_id).then( result => {\n        this.mensajito= result.data;\n      }).then(()=>{\n        this.fetchData(modem_id);\n      });\n\n\n\n    },\n    recargaConstante(comandos){\n      var trs = [];\n      var sResp = 0;\n      comandos.map(myFunction);\n      function myFunction(item, index) {\n        if(!item.respuesta)sResp++\n        trs.push(item.tr_id);\n      }\n      this.recargas = sResp;\n      this.trs      = trs;\n      console.log(this.recargas);\n      //this.fetchData(this.trs);\n      /*if(this.recargas>0){\n          console.log(\"quedan : \"+this.recargas+ \" sin respuestas\");\n          console.log(new Date());\n          this.trs.map(myFunction);\n          function myFunction(item, index) {\n            console.log(item);\n            \n          }\n          var i=0;\n          do {\n            i += 1;\n            console.log(i);\n            this.search(equipo_id);\n            sleep(150000) ;\n          } while (i < this.recargas);\n        }else{\n          console.log(\"no hay comandos no itero un choto\");\n        }*/\n    }\n    \n  }\n}\nfunction sleep(milliseconds) {\n  var start = new Date().getTime();\n  for (var i = 0; i < 1e7; i++) {\n    if ((new Date().getTime() - start) > milliseconds){\n      break;\n    }\n  }\n}\n</script>\n<style scoped>\n  .fade-enter-active {\n    transition: all .3s ease;\n  }\n  .fade-leave-active {\n    transition: all .8s cubic-bezier(1.0, 0.5, 0.8, 1.0);\n  }\n  .fade-enter, .fade-leave-to {\n    transform: translateX(10px);\n    opacity: 0;\n  }\n</style>\n"]}]}